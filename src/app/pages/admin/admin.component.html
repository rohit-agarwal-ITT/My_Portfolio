<div class="admin-container">
  <div class="admin-header">
    <h1 class="admin-title">Admin Dashboard</h1>
    <p class="admin-subtitle">Visitor Analytics</p>
  </div>

  <div class="admin-content">
    <div class="stats-section">
      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-users"></i>
        </div>
        <div class="stat-content">
          <h3 class="stat-number">{{ (visitors$ | async)?.length || 0 }}</h3>
          <p class="stat-label">Total Visitors</p>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-clock"></i>
        </div>
        <div class="stat-content">
          <h3 class="stat-number">{{ getTodayVisitorsCount((visitors$ | async) || []) }}</h3>
          <p class="stat-label">Today's Visitors</p>
        </div>
      </div>
    </div>

    <div class="visitors-section">
      <div class="section-header">
        <h2 class="section-title">Recent Visitors</h2>
        <div class="loading-spinner" *ngIf="loading">
          <i class="fas fa-spinner fa-spin"></i>
          <span>Loading visitors...</span>
        </div>
      </div>

      <div class="error-message" *ngIf="error">
        <i class="fas fa-exclamation-triangle"></i>
        <span>{{ error }}</span>
      </div>

      <div class="visitors-grid" *ngIf="!loading && !error">
        <div class="visitor-card" *ngFor="let visitor of visitors$ | async" (click)="selectVisitor(visitor)">
          <div class="visitor-header">
            <div class="visitor-info">
              <h3 class="visitor-name">{{ visitor.name }}</h3>
              <p class="visitor-mobile">{{ visitor.mobile }}</p>
            </div>
            <div class="visitor-actions">
              <button class="action-btn view-btn" (click)="selectVisitor(visitor); $event.stopPropagation()">
                <i class="fas fa-eye"></i>
              </button>
              <button class="action-btn delete-btn" (click)="deleteVisitor(visitor.id); $event.stopPropagation()">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </div>
          
          <div class="visitor-content">
            <div class="visitor-details">
              <span class="device-info">
                <i class="fas fa-mobile-alt"></i>
                {{ getDeviceInfo(visitor.userAgent || '') }}
              </span>
            </div>
          </div>
          
          <div class="visitor-footer">
            <span class="visitor-date">
              <i class="fas fa-calendar"></i>
              {{ formatDate(visitor.timestamp) }}
            </span>
          </div>
        </div>

        <div class="no-visitors" *ngIf="(visitors$ | async)?.length === 0">
          <i class="fas fa-users"></i>
          <h3>No visitors yet</h3>
          <p>Visitor information will appear here when users visit your portfolio</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Visitor Detail Modal -->
  <div class="modal-overlay" *ngIf="selectedVisitor" (click)="closeVisitor()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2 class="modal-title">Visitor Details</h2>
        <button class="close-btn" (click)="closeVisitor()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <div class="modal-body" *ngIf="selectedVisitor">
        <div class="detail-row">
          <label>Name:</label>
          <div class="detail-value">
            <strong>{{ selectedVisitor.name }}</strong>
          </div>
        </div>
        
        <div class="detail-row">
          <label>Mobile:</label>
          <div class="detail-value">{{ selectedVisitor.mobile }}</div>
        </div>
        
        <div class="detail-row">
          <label>Device:</label>
          <div class="detail-value">{{ getDeviceInfo(selectedVisitor.userAgent || '') }}</div>
        </div>
        
        <div class="detail-row">
          <label>Visit Date:</label>
          <div class="detail-value">{{ formatDate(selectedVisitor.timestamp) }}</div>
        </div>
        
        <div class="detail-row full-width" *ngIf="selectedVisitor.userAgent">
          <label>User Agent:</label>
          <div class="detail-value user-agent-text">{{ selectedVisitor.userAgent }}</div>
        </div>
      </div>
      
      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="closeVisitor()">Close</button>
        <button class="btn btn-danger" (click)="deleteVisitor(selectedVisitor.id); closeVisitor()">
          <i class="fas fa-trash"></i>
          Delete Record
        </button>
      </div>
    </div>
  </div>
</div> 